% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatialFoldDiagnostics.R
\name{check_folds}
\alias{check_folds}
\alias{check_folds.DataFolds}
\title{Check Spatial Folds Independence}
\usage{
check_folds(object, ...)

\method{check_folds}{DataFolds}(object, rho = NULL, plot = TRUE, ...)
}
\arguments{
\item{object}{A \code{DataFolds} object created by \code{create_folds()}.}

\item{...}{Additional arguments.}

\item{rho}{Numeric. Optional. The spatial range (km) estimated from the exploratory
analysis (e.g., \link[blockCV]{cv_spatial_autocor}) and used as the block size or
the one estimated from the integrated model (e.g., the Matérn range parameter).}

\item{plot}{Logical. If \code{TRUE}, returns a diagnostic plot.}
}
\value{
An object of class \code{GeoDiagnostic}.
}
\description{
Evaluates the geometric properties of spatial folds to ensure spatial independence
for cross-validation. This function verifies if block sizes and inter-block gaps
are sufficient relative to the prior or model's estimated spatial range (\eqn{\rho}).
}
\details{
The function assesses independence based on the minimum gap between folds
compared to the spatial range (\eqn{\rho}):
\itemize{
\item \strong{Contiguous}: Gap = 0. High risk of spatial leakage; observations in
test folds are spatially correlated with training data.
\item \strong{Weakly Independent}: 0 < Gap < \eqn{\rho}. A physical gap exists,
but correlation remains above 0.1.
\item \strong{Independent}: \eqn{\rho \le} Gap < \eqn{2\rho}. Spatial correlation
is below 0.1 at the boundary; considered robust for most CV applications.
\item \strong{Strongly Independent}: Gap \eqn{\ge 2\rho}. Spatial correlation
is effectively zero, providing the most rigorous test of model extrapolation.
}
}
\examples{
\dontrun{
library(sf)
library(terra)
library(ggplot2)
library(isdmtools)

# Generate the data as a list of sf objects
set.seed(42)
presence_data <- data.frame(
 x = runif(100, 0, 4),
 y = runif(100, 6, 13),
 site = rbinom(100, 1, 0.6)
) \%>\% st_as_sf(coords = c("x", "y"), crs = 4326)

count_data <- data.frame(
  x = runif(50, 0, 4),
 y = runif(50, 6, 13),
 count = rpois(50, 5)
) \%>\% st_as_sf(coords = c("x", "y"), crs = 4326)

datasets_list <- list(Presence = presence_data, Count = count_data)

ben_coords <- matrix(c(0, 6, 4, 6, 4, 13, 0, 13, 0, 6), ncol = 2, byrow = TRUE)
ben_sf <- st_sfc(st_polygon(list(ben_coords)), crs = 4326)
ben_sf <- st_sf(data.frame(name = "Benin"), ben_sf)

# Create Folds using create_folds()
folds <- create_folds(
  datasets_list,
  region_polygon = ben_sf,
  k = 5,
  cv_method = "cluster"
)

# Check Spatial Independence
# Assuming autocorrelation range (rho) is 150 km
spat_diag <- check_folds(folds, rho = 150, plot = TRUE)

# View results
print(spat_diag)
plot(spat_diag)
}
}
\references{
\itemize{
\item Roberts DR, Bahn V, Ciuti S, Boyce MS, Elith J, Guillera-Arroita G, Hauenstein S, Lahoz-Monfort JJ, Schröder B, Thuiller W, et al. Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. \emph{Ecography} (2017) 40:913–929. \doi{10.1111/ecog.02881}
}
}
\seealso{
Other blocks diagnostics: 
\code{\link{check_env_balance}()},
\code{\link{print.EnvDiagnostic}()},
\code{\link{print.FoldsSummary}()},
\code{\link{print.GeoDiagnostic}()},
\code{\link{summarise_fold_diagnostics}()}
}
\concept{blocks diagnostics}
