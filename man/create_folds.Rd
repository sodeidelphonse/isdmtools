% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SpatialFolds.R
\name{create_folds}
\alias{create_folds}
\title{Create block cross-validation folds for multisource spatial datasets}
\usage{
create_folds(
  datasets,
  region_polygon = NULL,
  k = 5,
  seed = 23,
  cv_method = "cluster",
  ...
)
}
\arguments{
\item{datasets}{A named list of \code{sf} objects. Each list element should be a
spatial dataset with its name corresponding to the list element's name.}

\item{region_polygon}{An \code{sf} object representing the study area polygon.}

\item{k}{integer. It specifies the number of folds (k-fold cross-validation).}

\item{seed}{integer. It sets seed for reproducibility.}

\item{cv_method}{character. It specifies the spatial cross-validation method to use.
Options are \code{"cluster"} (default) or \code{"spatial"}, see \link[blockCV]{cv_cluster} or \link[blockCV]{cv_spatial} functions.
For \code{"block"}, \code{"buffer"}, \code{"location"}, or \code{"nndm"}, see the corresponding functions in the \code{spatialsample} package.}

\item{...}{Additional arguments to be passed to the underlying blocking function in \code{blockCV} or \code{spatialsample}.}
}
\value{
An S3 object of class \code{DataFolds} containing the combined data,
fold information, and the original datasets.
}
\description{
A constructor function for the \code{DataFolds} S3 class. It binds multiple \code{sf} datasets
into a single object and generates spatially or environmentally-separated cross-validation folds.
}
\details{
This function first binds all datasets into a single \code{sf} object. It then applies the chosen blocking method to create spatial folds.
The fold IDs are added to the combined data object, and the original datasets and other relevant information are
stored in the returned \code{DataFolds} object.

The \code{"cluster"} method from the \code{blockCV} package, supports both spatial and environmental clustering.
Methods \code{"block"}, \code{"buffer"}, \code{"nndm"}, and \code{"location"}are useful for distance-based exclusion (buffering)
or leaving out specific groups/locations (e.g., using \code{group = "column_name"} with the \link[spatialsample]{spatial_leave_location_out_cv} method).
Use \code{"spatial"} for \code{blockCV} grid-blocking, or \code{"block"} for \code{spatialsample} grid-blocking.

The behavior of \code{create_folds} depends on the \code{cv_method} chosen.
Several methods require specific arguments passed via the ellipsis (\code{...}):
\itemize{
\item \bold{\code{block} & \code{buffer}}: Accept \code{radius} and \code{buffer}
arguments to define the size of the test/assessment areas and the width of
the exclusion zones, respectively. Particularly, for grid-blocking with \code{"block"} scheme,
additional arguments to \link[sf]{st_make_grid} can be provided.
\item \bold{\code{nndm}}: Requires \code{prediction_sites}, an \code{sf}
object representing the area where the model will be projected.
\item \bold{\code{location}}: Requires a \code{group} argument (character).
This should be the name of a column in your datasets representing
independent units like \code{"site_id"}, \code{"year"}, or \code{"observer"}.
This tests model generalizability across these factors. It also accepts
\code{radius} and \code{buffer} arguments for the size of assessment areas
and the width of the exclusion zones, respectively.
}
}
\examples{
\dontrun{
# Create some dummy sf data with different columns
library(sf)
set.seed(42)
presence_data <- data.frame(
  x = runif(100, 0, 4),
  y = runif(100, 6, 13),
  site = rbinom(100, 1, 0.6)
) \%>\% st_as_sf(coords = c("x", "y"), crs = 4326)

count_data <- data.frame(
  x = runif(50, 0, 4),
  y = runif(50, 6, 13),
  count = rpois(50, 5)
) \%>\% st_as_sf(coords = c("x", "y"), crs = 4326)

# Create a list of datasets
datasets_list <- list(Presence = presence_data, Count = count_data)

# Create a dummy polygon for the region (e.g. Benin's minimum bounding rectangle)
ben_coords <- matrix(c(0, 6, 4, 6, 4, 13, 0, 13, 0, 6), ncol = 2, byrow = TRUE)
ben_sf <- st_sfc(st_polygon(list(ben_coords)), crs = 4326)
ben_sf <- st_sf(data.frame(name = "Benin"), ben_sf)

# Create a DataFolds object using the default 'cluster' method
my_folds <- create_folds(datasets_list, ben_sf, k = 5)
print(my_folds)
}

}
\references{
Mahoney MJ, Johnson LK, Silge J, Frick H, Kuhn M, Beier CM. Assessing the performance of spatial cross-validation approaches for models of spatially structured data. \emph{arXiv} (2023) \doi{10.48550/arXiv.2303.07334}

Roberts DR, Bahn V, Ciuti S, Boyce MS, Elith J, Guillera-Arroita G, Hauenstein S, Lahoz-Monfort JJ, Schröder B, Thuiller W, et al. Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. \emph{Ecography} (2017) 40:913–929. \doi{10.1111/ecog.02881}

Valavi R, Elith J, Lahoz-Monfort JJ, Guillera-Arroita G. blockCV: an R package for generating spatially or environmentally separated folds for k-fold cross-validation of species distribution models. \emph{bioRxiv} (2018). \doi{10.1101/357798}
}
\seealso{
Other spatial blocking methods: 
\code{\link{extract_fold}()},
\code{\link{plot.DataFolds}()}
}
\concept{spatial blocking methods}
