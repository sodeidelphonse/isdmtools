% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Suitability.R
\name{suitability_index}
\alias{suitability_index}
\title{Compute a unified suitability index from integrated spatial model predictions.}
\usage{
suitability_index(
  x,
  post.stat = "mean",
  output.format = c("prob", "response", "linear"),
  response.type = c("joint.po", "count.pa", "po", "count", "pa"),
  has.offset = FALSE,
  projection = NULL,
  ...
)
}
\arguments{
\item{x}{A \code{data.frame} containing \code{X} and \code{Y} coordinates and the column(s) of the predicted linear predictor variables (e.g., mean, standard deviation and quantiles for Bayesian models).
It can typically be a standardised grid-based output from a \link{prepare_predictions} call to various classes of spatial prediction on a linear scale, e.g. from the \code{PointedSDMs} or \code{inlabru} packages.
It can also be a \code{SpatRaster} object containing the prediction variables as the layers' names.}

\item{post.stat}{A character vector specifying the column or layer name(s) to use for the predictions. Defaults to "mean".}

\item{output.format}{A character string indicating the desired output format. Must be one of "prob" (for a probability-based suitability index), "response" (for the expected count or rate) or "linear" (for the linear predictor scale).}

\item{response.type}{A character string specifying the type of response data the model was fitted with.
Must be one of "joint.po" (joint model including presence-only data), "count.pa" (joint model with count and presence-absence), "po" (single presence-only model), "count" (count model), or "pa" (presence-absence model).}

\item{has.offset}{A logical value. For \code{count.pa}, \code{count} and \code{pa} models, this should be \code{TRUE} if the linear predictor includes an explicit area offset.
This argument is not used for "po" or "joint.po" models. Defaults to \code{FALSE} (sensible value).}

\item{projection}{A character string or object specifying the coordinate reference system (CRS) for the output raster. Defaults to \code{NULL}.}

\item{...}{Additional arguments passed to the S4 method \link[terra]{rast} for signature 'data.frame'.}
}
\value{
A SpatRaster object (single or multi-layer) representing either the suitability
index (probabilities, if \code{output.format = "prob"}) or the expected count/rate (if \code{output.format = "response"}).
}
\description{
This function converts the linear predictor (\code{eta}) from a fitted integrated spatial model
into a unified suitability index, which can be interpreted as a probability of a species presence
or species \emph{hotspots}. It also returns the intensity or expected count, depending on whether the model has offset or not.
}
\details{
This function implements a unified framework for converting model predictions to a
comparable suitability index. The method relies on the \emph{Inhomogeneous Poisson Process (IPP)}
theory, where the linear predictor \code{eta} is related to the probability of presence
via the inverse complementary log-log link: \code{p(presence) = 1 - exp(-scaling * exp(eta))}.

The \code{scaling} factor is determined by the \code{response.type} and the \code{has.offset} arguments:

\itemize{
\item For PO models (single or part of a joint model), \code{eta} is always a log-rate, and the \code{scaling} is automatically set to the cell area.
\item For Count or PA models, if \code{has.offset = TRUE}, \code{eta} is a log-rate, and \code{scaling} is the cell area.
\item In all other cases (\code{has.offset = FALSE}), \code{eta} is treated as a log of the expected count/probability, and \code{scaling} is set to \code{1}.
}
}
\examples{
\dontrun{
library(terra)
# Simulate a sample data.frame with X, Y, and a linear predictor
set.seed(42)
x <- expand.grid(X = seq(0, 50, 1), Y = seq(0, 50, 1))
x$eta <- rnorm(nrow(x), mean = 0, sd = 1)

# Create a simple raster object
x_rast <- rast(x)

# Generate a suitability index for a Presence-Absence model
pa_probability <- suitability_index(
  x_rast,
  post.stat = "eta",
  response.type = "pa"
)
plot(pa_probability)

# Create a binary map using a fixed threshold
binary_map <- app(pa_probability, function(x) ifelse(x < 0.5, 0, 1))
plot(binary_map)

# Generate an expected mean (assume "eta" is from a count model)
count_expected_mean <- suitability_index(
  x_rast,
  post.stat = "eta",
  response.type = "count",
  output.format = "response"
)
plot(count_expected_mean)
}

}
\references{
Dorazio RM. Accounting for imperfect detection and survey bias in statistical analysis of presence-only data. \emph{Global Ecology and Biogeography} (2014) 23:1472–1484.

Fithian W, Elith J, Hastie T, Keith DA. Bias correction in species distribution models: pooling survey and collection data for multiple species. \emph{Methods in Ecology and Evolution} (2015) 6:424–438. \doi{10.1111/2041-210X.12242}
}
\seealso{
Other prediction analyses: 
\code{\link{generate_maps}()},
\code{\link{prepare_predictions}()}
}
\concept{prediction analyses}
