% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FillingRaster.R
\name{fill_na_near}
\alias{fill_na_near}
\title{Fill NA cells with the nearest cells values}
\usage{
fill_na_near(
  x,
  boundary = NULL,
  fun = mean,
  na.policy = "only",
  na.rm = TRUE,
  start.window = 1,
  ...
)
}
\arguments{
\item{x}{A raster layer (\code{SpatRaster} or \code{RasterLayer}) with missing values to fill in.
For multiple rasters (\code{SpatRaster} or \code{RasterStack}), you can use the combination of \code{lapply()} and \code{rast()} functions with this function.}

\item{boundary}{A optional spatial polygon object (\code{spatVector} or \code{sf}) to be used to mask extra cells outside the study region.
It must have the same coordinates reference system (CRS) with the input raster. Defaults to \code{NULL}.}

\item{fun}{A function to compute a value for a cell based on the values of its neighbors. The default is \code{mean}.
This function must take a vector of values and return a single value (e.g., mean, modal, min or max) or multiple values (e.g., quantile).}

\item{na.policy}{Character. Specifies which cells to fill. Must be one of "all" (compute for all cells),
"only" (only for cells that are NA) or "omit" (skip cells that are NA). The default \code{"only"} ensures that only cells
that are NA in the input raster are filled.}

\item{na.rm}{Logical. If \code{TRUE}, NA values in the neighborhood are ignored when computing
the focal function. The default is \code{TRUE}.}

\item{start.window}{A positive odd integer specifying the starting size of the square focal window.
The window will be \verb{(2w+1) x (2w+1)}. The default is \code{1}, which corresponds to a 3x3 start window.}

\item{...}{Additional arguments passed to the internal \link[terra]{focal} function.
This includes arguments like \code{expand}, \code{silent}, \code{filename}, etc. Note that a custom \code{w} (e.g., a weights matrix)
cannot be passed via \code{...} as this function's logic is built around an iterative square window.}
}
\value{
A \code{SpatRaster} object that has all of its NA cells filled in.
}
\description{
Function to impute a raster object for spatial modeling tools that cannot handle missing values in covariates.
The function fill in NA cells with the nearest cells values using a moving window on missing cells.
It is an iterative version of the \link[terra]{focal} function of \code{terra} to handle incomplete filling
due to isolated NA cells surrounded by other NAs.
}
\examples{
\dontrun{
library(terra)
# Create a sample raster with some NA values
r <- terra::rast(nrows = 10, ncols = 10, res = 1, xmin = 0, ymin = 0)
r[] <- 1:100
r[c(10, 25, 50, 75, 90)] <- NA

# Fill the NAs using the default mean function with 3x3 window
r_filled <- fill_na_near(r)

# Start the filling with a larger 5x5 window
r_filled_large_start <- fill_na_near(r, start.window = 3)

plot(r, main = "Original raster")
plot(r_filled, main = "Filled with mean (3x3 start)")
plot(r_filled_large_start, main = "Filled with mean (5x5 start)")
}

}
