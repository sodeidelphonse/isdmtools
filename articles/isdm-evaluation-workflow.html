<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ISDM Evaluation Workflow ‚Ä¢ isdmtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ISDM Evaluation Workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">isdmtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/isdmtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/isdmtools.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/isdm-evaluation-workflow.html">ISDM Evaluation Workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">All Articles</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sodeidelphonse/isdmtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ISDM Evaluation Workflow</h1>
                        <h4 data-toc-skip class="author">Akoeugnigan
Idelphonse SODE</h4>
            
            <h4 data-toc-skip class="date">Generated on 2026-02-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sodeidelphonse/isdmtools/blob/main/vignettes/isdm-evaluation-workflow.Rmd" class="external-link"><code>vignettes/isdm-evaluation-workflow.Rmd</code></a></small>
      <div class="d-none name"><code>isdm-evaluation-workflow.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sodeidelphonse.github.io/isdmtools/">isdmtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inlabru-org.github.io/fmesher/" class="external-link">fmesher</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.inlabru.org" class="external-link">inlabru</a></span><span class="op">)</span></span>
<span><span class="co">#library(INLA)  # required</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>As demonstrated in the <a href="isdmtools.html">Get started</a>
guide, the first output from the <code>isdmtools</code> package is a set
of clean <code>sf</code> objects, which makes it easy to integrate with
various spatial modeling tools using block cross-validation techniques.
The extracted training and testing data can be directly fed into your
preferred integrated modeling tools such as <code>inlabru</code>,
<code>PointedSDMs</code>, or any <code>GLMs/GAMs</code> tools that can
accommodate multisource spatial data. This ensures that your model
predictions are validated using a robust spatial cross-validation
approach and comprehensive evaluation metrics.</p>
<p>This vignette shows how how the isdmtools can be used with other
predictive modelling tools such as <code>inlabru</code> for a complete
workflow of integrated species distribution modelling (ISDM)
analysis.</p>
<div class="section level3">
<h3 id="step-1-fitting-a-bayesian-integrated-model-with-the-inlabru">Step 1: Fitting a Bayesian integrated model with the
<code>inlabru</code><a class="anchor" aria-label="anchor" href="#step-1-fitting-a-bayesian-integrated-model-with-the-inlabru"></a>
</h3>
<p>The <code>inlabru</code> package is a wrapper for the
<code>R-INLA</code> package which is designed for Bayesian Latent
Gaussian Modelling using INLA (Integrated Laplace Nested Approximations)
and Extensions. Let‚Äôs develop a Bayesian spatial model with the
simulated data presented in <a href="isdmtools.html">Get started</a>
guide.</p>
<ul>
<li><strong>Model definition</strong></li>
</ul>
<p>We assume the following basic joint model with a shared latent signal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œæ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi(.)</annotation></semantics></math>
(i.e.¬†a Gaussian random field):</p>
<pre class="math"><code> \begin{matrix} 
 Y_{\mathrm{count},i}|\xi(.) \sim \mathrm{Pois} \left(\mu_i \right), \quad i = 1,\ldots,n,\\
 \log(\mu_i) = \beta_{0,\mathrm{count}} + \xi(\mathbf{s}_i)\\[3mm]
 X_{\mathrm{presence}}|\xi(.) \sim \mathrm{IPP} \left(\lambda(\mathbf{s}) \right),\\
\log (\lambda(\mathbf{s})) = \beta_{0,\mathrm{presence}} + \xi(\mathbf{s})\\
\end{matrix}</code></pre>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">I</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">P</mi></mrow><annotation encoding="application/x-tex">\mathrm{IPP}</annotation></semantics></math>
means a <em>Inhomogeneous Poisson Process</em> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùê¨</mi><annotation encoding="application/x-tex">\mathbf{s}</annotation></semantics></math>
the vector of a location coordinates.</p>
<p>You can now prepare the remaining data required to fit an integrated
model. First, we need to define the mesh to be used to approximate the
latent field as well as for the integration points in the IPP
likelihood. After this step, we set up the prior distributions for the
latent parameters such as the range and the marginal standard deviation.
Then we define the observation model for each data type to fuse them
using a joint likelihood estimation with INLA.</p>
<ul>
<li><strong>Model implementation</strong></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a "mesh" for the latent field </span></span>
<span><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu">fmesher</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d</a></span><span class="op">(</span></span>
<span>     boundary <span class="op">=</span> <span class="va">ben_sf</span>,</span>
<span>     max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-3</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>     cutoff <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>     crs <span class="op">=</span> <span class="st">"epsg:4326"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/gg.html" class="external-link">gg</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the PC-prior for the SPDE model. We estimate a longer range value as no spatial </span></span>
<span><span class="co"># autocorrelation was defined in the data generation process:</span></span>
<span><span class="va">pcmatern</span> <span class="op">&lt;-</span> <span class="fu">INLA</span><span class="fu">::</span><span class="fu">inla.spde2.pcmatern</span><span class="op">(</span><span class="va">mesh</span>,</span>
<span>                                      prior.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="co"># P(spatial range &lt; 1) = 0.1</span></span>
<span>                                      prior.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># P(sigma &gt; 1) = 0.1</span></span>
<span>                                      <span class="op">)</span></span>
<span>   </span>
<span><span class="co"># The shared spatial latent component is denoted by 'spde'</span></span>
<span><span class="va">jcmp</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">Presence_intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">Count_intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>                  <span class="fu">spde</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="va">pcmatern</span><span class="op">)</span></span>
<span>   </span>
<span><span class="co"># Count observation model</span></span>
<span><span class="va">obs_model_count</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_obs.html" class="external-link">bru_obs</a></span><span class="op">(</span></span>
<span>     formula <span class="op">=</span> <span class="va">count</span> <span class="op">~</span>  <span class="op">+</span> <span class="va">Count_intercept</span> <span class="op">+</span> <span class="va">spde</span>,</span>
<span>     family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>     data <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">Count</span></span>
<span> <span class="op">)</span></span>
<span>   </span>
<span><span class="co"># Presence-only observation model (LGCP)</span></span>
<span><span class="va">obs_model_pres</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_obs.html" class="external-link">bru_obs</a></span><span class="op">(</span></span>
<span>     formula <span class="op">=</span> <span class="va">geometry</span> <span class="op">~</span> <span class="va">Presence_intercept</span> <span class="op">+</span> <span class="va">spde</span>,</span>
<span>     family <span class="op">=</span> <span class="st">"cp"</span>,</span>
<span>     data <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">Presence</span>,</span>
<span>     domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">mesh</span><span class="op">)</span>,</span>
<span>     samplers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">ben_sf</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>   </span>
<span><span class="co"># Model fit</span></span>
<span><span class="va">jfit</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">jcmp</span>, <span class="va">obs_model_count</span>, <span class="va">obs_model_pres</span>,</span>
<span>                        options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>control.inla <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>int.strategy <span class="op">=</span> <span class="st">"eb"</span><span class="op">)</span>,</span>
<span>                                       bru_max_iter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span></code></pre></div>
<p>We can collect model results after the fitting process.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">jfit</span><span class="op">$</span><span class="va">summary.fixed</span></span>
<span> <span class="co">#&gt;                     mean        sd      0.025quant  0.5quant   0.975quant  mode      kld</span></span>
<span> <span class="co">#&gt; Count_intercept    -0.2497590 0.3086958 -0.8547916 -0.2497590  0.3552737  -0.2497590  0</span></span>
<span> <span class="co">#&gt; Presence_intercept  0.9269141 0.2836352  0.3709992  0.9269141  1.4828289   0.9269141  0</span></span>
<span> <span class="co">#&gt;  </span></span>
<span> <span class="va">jfit</span><span class="op">$</span><span class="va">summary.hyperpar</span></span>
<span> <span class="co">#&gt;                mean        sd      0.025quant  0.5quant   0.975quant  mode</span></span>
<span> <span class="co">#&gt; Range for spde 3.535334 2.5240208  0.9513318   2.8572241  10.2509603  1.9527898</span></span>
<span> <span class="co">#&gt; Stdev for spde 0.512346 0.1926203  0.2183487   0.4842595  0.9647017   0.4317979</span></span></code></pre></div>
<p>As expected, the estimated <em>spatial range</em> is higher than 1.
This is because there is no strong spatial autocorrelation in the
simulated data.</p>
</div>
<div class="section level3">
<h3 id="step-2-model-prediction">Step 2: Model prediction<a class="anchor" aria-label="anchor" href="#step-2-model-prediction"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the prediction grids and projection system</span></span>
<span><span class="va">grids</span>      <span class="op">&lt;-</span> <span class="fu">fmesher</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_pixels.html" class="external-link">fm_pixels</a></span><span class="op">(</span><span class="va">mesh</span>, mask <span class="op">=</span> <span class="va">ben_sf</span><span class="op">)</span></span>
<span><span class="va">projection</span> <span class="op">&lt;-</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model predictions</span></span>
<span><span class="va">jpred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">jfit</span>, </span>
<span>                 newdata <span class="op">=</span> <span class="va">grids</span>, </span>
<span>                 formula <span class="op">=</span> <span class="op">~</span> <span class="va">spde</span> <span class="op">+</span> <span class="va">Presence_intercept</span>,</span>
<span>                 n.samples <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                 seed <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">jpred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_predictions.html">prepare_predictions</a></span><span class="op">(</span><span class="va">jpred</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">jpred_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">jfit</span>, </span>
<span>                       newdata <span class="op">=</span> <span class="va">grids</span>, </span>
<span>                       formula <span class="op">=</span> <span class="op">~</span> <span class="va">spde</span> <span class="op">+</span> <span class="va">Count_intercept</span> ,</span>
<span>                       n.samples <span class="op">=</span> <span class="fl">500</span>, seed <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">jpred_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_predictions.html">prepare_predictions</a></span><span class="op">(</span><span class="va">jpred_count</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-habitat-suitability-analysis">Step 3: Habitat suitability analysis<a class="anchor" aria-label="anchor" href="#step-3-habitat-suitability-analysis"></a>
</h3>
<p>Once we have obtained the model predictions, we can then use the
<code>isdmtools</code> to perform habitat suitability analysis. This
will allow us to proceed with the evaluation of models and the
visualisation of results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probability of presence</span></span>
<span><span class="va">jt_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/suitability_index.html">suitability_index</a></span><span class="op">(</span><span class="va">jpred</span>, </span>
<span>                            post_stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q0.025"</span>, <span class="st">"mean"</span>, <span class="st">"q0.975"</span><span class="op">)</span>, </span>
<span>                            output_format <span class="op">=</span> <span class="st">"prob"</span>,</span>
<span>                            response_type <span class="op">=</span> <span class="st">"joint.po"</span>,</span>
<span>                            projection <span class="op">=</span> <span class="va">projection</span>,</span>
<span>                            scale_independent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                            <span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">jt_prob</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expected counts</span></span>
<span><span class="va">jt_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/suitability_index.html">suitability_index</a></span><span class="op">(</span><span class="va">jpred_count</span>, </span>
<span>                              post_stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q0.025"</span>, <span class="st">"mean"</span>, <span class="st">"q0.975"</span><span class="op">)</span>, </span>
<span>                              output_format <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>                              response_type <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>                              projection <span class="op">=</span> <span class="va">projection</span></span>
<span>                              <span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">jt_count</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-model-performance-evaluation-using-the-test-data">Step 4: Model performance evaluation using the test data<a class="anchor" aria-label="anchor" href="#step-4-model-performance-evaluation-using-the-test-data"></a>
</h3>
<p>Various performance metrics can now be computed, including
dataset-specific and weighted composite scores.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">xy_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">datasets_list</span><span class="op">$</span><span class="va">Presence</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>              <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">datasets_list</span><span class="op">$</span><span class="va">Count</span><span class="op">)</span><span class="op">[</span><span class="va">datasets_list</span><span class="op">$</span><span class="va">Count</span><span class="op">$</span><span class="va">count</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>   </span>
<span> <span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span>, <span class="st">"tss"</span>, <span class="st">"accuracy"</span>, <span class="st">"rmse"</span>, <span class="st">"mae"</span><span class="op">)</span></span>
<span> <span class="va">eval_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_metrics.html">compute_metrics</a></span><span class="op">(</span><span class="va">test_data</span>, </span>
<span>                                prob_raster <span class="op">=</span> <span class="va">jt_prob</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>                                expected_response <span class="op">=</span> <span class="va">jt_count</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>                                xy_excluded <span class="op">=</span> <span class="va">xy_observed</span>, </span>
<span>                                metrics <span class="op">=</span> <span class="va">metrics</span>,</span>
<span>                                overall_roc_metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span>, <span class="st">"tss"</span>, <span class="st">"accuracy"</span><span class="op">)</span>,</span>
<span>                                response_counts <span class="op">=</span> <span class="st">"count"</span></span>
<span>                                <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_metrics</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; ISDM Model Evaluation Results</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; Datasets Evaluated: Presence, Count </span></span>
<span></span>
<span><span class="co">#&gt; Overall Performance:</span></span>
<span><span class="co">#&gt;  TOT ROC SCORE     : 0.8048</span></span>
<span><span class="co">#&gt;  TOT ERROR SCORE   : 1.9353</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span></code></pre></div>
<p>One can obtain detailed overview of the evaluation results via the
<code><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary()</a></code> method.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eval_metrics</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; ==============================================</span></span>
<span><span class="co">#&gt;        ISDM EVALUATION SUMMARY REPORT</span></span>
<span><span class="co">#&gt; ==============================================</span></span>
<span><span class="co">#&gt; Generated on: 2026-01-19 04:41:02 </span></span>
<span></span>
<span><span class="co">#&gt; --- Model Evaluation Settings ---</span></span>
<span><span class="co">#&gt; Random Seed         : 25</span></span>
<span><span class="co">#&gt; Background Points   : 1000</span></span>
<span><span class="co">#&gt; Spatial Context     : BackgroundPoints object attached</span></span>
<span><span class="co">#&gt; Threshold Logic     : best</span></span>
<span><span class="co">#&gt; Optimality Criterion: youden</span></span>
<span><span class="co">#&gt; Prediction Type     : Absolute Count (No Offset)</span></span>
<span></span>
<span><span class="co">#&gt; --- Detailed Metric Table ---</span></span>
<span><span class="co">#&gt;         Presence Count</span></span>
<span><span class="co">#&gt; AUC         0.917 0.750</span></span>
<span><span class="co">#&gt; TSS         0.791 0.750</span></span>
<span><span class="co">#&gt; ACCURACY    0.794 0.778</span></span>
<span><span class="co">#&gt; RMSE          N/A 2.119</span></span>
<span><span class="co">#&gt; MAE           N/A 1.752</span></span>
<span></span>
<span><span class="co">#&gt; --- Composite Scores (Weighted) ---</span></span>
<span><span class="co">#&gt;     AUC      TSS ACCURACY     RMSE      MAE </span></span>
<span><span class="co">#&gt;    0.852    0.775    0.788    2.119    1.752 </span></span>
<span></span>
<span><span class="co">#&gt; --- Overall Performance ---</span></span>
<span><span class="co">#&gt;  TOT ROC SCORE     : 0.8048</span></span>
<span><span class="co">#&gt;  TOT ERROR SCORE   : 1.9353</span></span>
<span><span class="co">#&gt; ==============================================</span></span></code></pre></div>
<p>As you will have noticed, continuous-outcome metrics such as MAE
(mean absolute error) and RMSE (root mean squared error) are not
available for presence-only data, which makes sense. Furthermore, the
weighted composite scores for continuous responses are identical to
their individual counterparts, since there is only one count response.
Moreover, you can check out the <a href="../reference/get_background.html"><code>get_background()</code></a>
documentation for more details on background sample generated during the
model evaluation.</p>
<p>Next, you can iterate through all five spatial folds to obtain an
average model performance, then calculate the variation in metrics
between blocks. Finally, run a model on the full ‚Äòdatasets_list‚Äô to make
the final prediction.</p>
</div>
<div class="section level3">
<h3 id="step-5-prediction-mapping">Step 5: Prediction mapping<a class="anchor" aria-label="anchor" href="#step-5-prediction-mapping"></a>
</h3>
<p>You can now generate a formal prediction map ready for
publication.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_maps.html">generate_maps</a></span><span class="op">(</span><span class="va">jt_prob</span>, </span>
<span>                   var_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q0.025"</span>, <span class="st">"mean"</span>, <span class="st">"q0.975"</span><span class="op">)</span>, </span>
<span>                   base_map <span class="op">=</span> <span class="va">ben_sf</span>,</span>
<span>                   legend_title <span class="op">=</span> <span class="st">"suitability"</span>,  </span>
<span>                   panel_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(a) q2.5%"</span>, <span class="st">"(b) Mean"</span>, <span class="st">"(c) q97.5%"</span><span class="op">)</span>,</span>
<span>                   xaxis_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   yaxis_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">13</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">map</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>You have successfully fused multi-source biodiversity data and
generated spatially independent partitions for robust model validation
using <code>isdmtools</code>. The toolkit has enabled the resampling of
data, thereby reducing spatial autocorrelation effects in the modelling
process. This has facilitated the analysis and a comprehensive
evaluation of ISDM using well-known metrics from the fields of
statistics and machine learning.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Akoeugnigan Idelphonse SODE.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
