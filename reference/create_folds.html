<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create block cross-validation folds for multisource spatial datasets — create_folds • isdmtools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create block cross-validation folds for multisource spatial datasets — create_folds"><meta name="description" content="A constructor function for the DataFolds S3 class. It binds multiple sf datasets
into a single object and generates spatially or environmentally-separated cross-validation folds."><meta property="og:description" content="A constructor function for the DataFolds S3 class. It binds multiple sf datasets
into a single object and generates spatially or environmentally-separated cross-validation folds."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">isdmtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/isdmtools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/isdm-evaluation-workflow.html">ISDM Evaluation Workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sodeidelphonse/isdmtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create block cross-validation folds for multisource spatial datasets</h1>
      <small class="dont-index">Source: <a href="https://github.com/sodeidelphonse/isdmtools/blob/main/R/SpatialFolds.R" class="external-link"><code>R/SpatialFolds.R</code></a></small>
      <div class="d-none name"><code>create_folds.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A constructor function for the <code>DataFolds</code> S3 class. It binds multiple <code>sf</code> datasets
into a single object and generates spatially or environmentally-separated cross-validation folds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_folds</span><span class="op">(</span></span>
<span>  <span class="va">datasets</span>,</span>
<span>  region_polygon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  cv_method <span class="op">=</span> <span class="st">"cluster"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bind_datasets</span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-datasets">datasets<a class="anchor" aria-label="anchor" href="#arg-datasets"></a></dt>
<dd><p>A named list of <code>sf</code> objects. Each list element should be a
spatial dataset with its name corresponding to the list element's name.
The list elements must have the same geographical projection and coordinates reference system (CRS).</p></dd>


<dt id="arg-region-polygon">region_polygon<a class="anchor" aria-label="anchor" href="#arg-region-polygon"></a></dt>
<dd><p>An <code>sf</code> object representing the study area polygon.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>integer. It specifies the number of folds (k-fold cross-validation).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer. It sets seed for reproducibility.</p></dd>


<dt id="arg-cv-method">cv_method<a class="anchor" aria-label="anchor" href="#arg-cv-method"></a></dt>
<dd><p>character. It specifies the spatial cross-validation method to use.
Options are <code>"cluster"</code> (default) or <code>"spatial"</code>, see <a href="https://rdrr.io/pkg/blockCV/man/cv_cluster.html" class="external-link">cv_cluster</a> or <a href="https://rdrr.io/pkg/blockCV/man/cv_spatial.html" class="external-link">cv_spatial</a> functions.
For <code>"block"</code>, <code>"buffer"</code>, <code>"location"</code>, or <code>"nndm"</code>, see the corresponding functions in the <code>spatialsample</code> package.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to the underlying blocking function in <code>blockCV</code> or <code>spatialsample</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An S3 object of class <code>DataFolds</code> containing the combined data,
fold information, the region polygon, and the original datasets.</p>
<p>An <code>sf</code> object containing all datasets along with their corresponding name.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function first binds all datasets into a single <code>sf</code> object. It then applies the chosen blocking method to create spatial folds.
The fold IDs are added to the combined data object, and the original datasets and other relevant information are
stored in the returned <code>DataFolds</code> object.</p>
<p>The <code>"cluster"</code> method from the <code>blockCV</code> package, supports both spatial and environmental clustering.
Methods <code>"block"</code>, <code>"buffer"</code>, <code>"nndm"</code>, and <code>"location"</code>are useful for distance-based exclusion (buffering)
or leaving out specific groups/locations (e.g., using <code>group = "column_name"</code> with the <a href="https://spatialsample.tidymodels.org/reference/spatial_vfold.html" class="external-link">spatial_leave_location_out_cv</a> method).
Use <code>"spatial"</code> for <code>blockCV</code> grid-blocking, or <code>"block"</code> for <code>spatialsample</code> grid-blocking.</p>
<p>The behavior of <code>create_folds</code> depends on the <code>cv_method</code> chosen.
Several methods require specific arguments passed via the ellipsis (<code>...</code>):</p><ul><li><p><b><code>block</code> &amp; <code>buffer</code></b>: Accept <code>radius</code> and <code>buffer</code>
arguments to define the size of the test/assessment areas and the width of
the exclusion zones, respectively. Particularly, for grid-blocking with <code>"block"</code> scheme,
additional arguments to <a href="https://r-spatial.github.io/sf/reference/st_make_grid.html" class="external-link">st_make_grid</a> can be provided.</p></li>
<li><p><b><code>nndm</code></b>: Requires <code>prediction_sites</code>, an <code>sf</code>
object representing the area where the model will be projected.</p></li>
<li><p><b><code>location</code></b>: Requires a <code>group</code> argument (character).
This should be the name of a column in your datasets representing
independent units like <code>"site_id"</code>, <code>"year"</code>, or <code>"observer"</code>.
This tests model generalizability across these factors. It also accepts
<code>radius</code> and <code>buffer</code> arguments for the size of assessment areas
and the width of the exclusion zones, respectively.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mahoney MJ, Johnson LK, Silge J, Frick H, Kuhn M, Beier CM. Assessing the performance of spatial cross-validation approaches for models of spatially structured data. <em>arXiv</em> (2023) <a href="https://doi.org/10.48550/arXiv.2303.07334" class="external-link">doi:10.48550/arXiv.2303.07334</a></p>
<p>Roberts DR, Bahn V, Ciuti S, Boyce MS, Elith J, Guillera-Arroita G, Hauenstein S, Lahoz-Monfort JJ, Schröder B, Thuiller W, et al. Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. <em>Ecography</em> (2017) 40:913–929. <a href="https://doi.org/10.1111/ecog.02881" class="external-link">doi:10.1111/ecog.02881</a></p>
<p>Valavi R, Elith J, Lahoz-Monfort JJ, Guillera-Arroita G. blockCV: an R package for generating spatially or environmentally separated folds for k-fold cross-validation of species distribution models. <em>bioRxiv</em> (2018). <a href="https://doi.org/10.1101/357798" class="external-link">doi:10.1101/357798</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other spatial blocking methods:
<code><a href="DataFolds-methods.html">DataFolds-methods</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create some dummy sf data with different columns</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">presence_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">6</span>, <span class="fl">13</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">6</span>, <span class="fl">13</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a list of datasets</span></span></span>
<span class="r-in"><span><span class="va">datasets_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Presence <span class="op">=</span> <span class="va">presence_data</span>, Count <span class="op">=</span> <span class="va">count_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a dummy polygon for the region (e.g. Benin's minimum bounding rectangle)</span></span></span>
<span class="r-in"><span><span class="va">ben_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">13</span>, <span class="fl">0</span>, <span class="fl">13</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ben_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ben_coords</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ben_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Benin"</span><span class="op">)</span>, <span class="va">ben_sf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a DataFolds object using the default 'cluster' method</span></span></span>
<span class="r-in"><span><span class="va">my_folds</span> <span class="op">&lt;-</span> <span class="fu">create_folds</span><span class="op">(</span><span class="va">datasets_list</span>, <span class="va">ben_sf</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_folds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Akoeugnigan Idelphonse SODE.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

